# Visa 更新ユーザーフロー (シミュレート)

このメモは、実際の利用者になったつもりで在留期間更新（visa 更新）を進めるときの操作と期待結果をまとめたものです。現環境ではバックエンド/DB を起動していないため、以下は UI 挙動と既存実装に基づくシミュレーション手順です。

## 1. ログイン
- `frontend/login.html` を開き、**ユーザー名**と**パスワード**を入力する。入力欄はどちらも必須で、必要に応じて「ログイン状態を保持」チェックをオンにする。
- 送信するとトークンが保存され、従業員一覧などの保護ページへ遷移できる想定。

## 2. 更新案内ページを確認
- メニューから「在留期間更新」を開くと `frontend/visa-renewal.html` が表示される。
- ページ中央の案内に従い、「従業員一覧へ移動」ボタンをクリックして実際の申請対象を選びに行く。

## 3. 従業員を選択
- `frontend/employees.html` でリストを確認する。検索や国籍・在留期限フィルターで対象者を絞り込める。
- リスト行の右端にあるアクション群から、該当従業員の **📄 更新** ボタン（`title="更新申請書"`）を押す。

## 4. 申請書の生成
- ボタン押下で `/export/visa-renewal/{employeeId}` へ認証付きリクエストが送られ、レスポンスが正常なら `visa_renewal_{id}.xlsx` というファイルが自動ダウンロードされる。
- エラーの場合はバックエンドの詳細メッセージをアラートで表示し、ダウンロードは行われない。

## 5. 想定される確認ポイント
- トークン切れや未ログイン時には `checkAuth()` がログインページへリダイレクトすること。
- 期限が近い従業員をフィルターで素早く見つけられること（「30日以内/60日以内/90日以内/期限切れ」）。
- ダウンロードされた Excel が正しい社員情報と期限を反映していること（実データは別途確認が必要）。

> 注: 上記は UI 実装と API エンドポイント構成に沿った操作イメージであり、今回の作業では Docker やバックエンドを起動しての実機確認は未実施。
