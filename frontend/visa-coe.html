<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ¨ç•™è³‡æ ¼èªå®šè¨¼æ˜æ›¸äº¤ä»˜ç”³è«‹æ›¸ - UNS Visa Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 min-h-screen">
    <!-- Navigation -->
    <nav class="bg-black/20 backdrop-blur-lg text-white p-4 shadow-lg border-b border-white/10">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-4">
                <a href="index.html" class="flex items-center gap-2 hover:opacity-80">
                    <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg">
                        <span class="text-2xl">ğŸ‡¯ğŸ‡µ</span>
                    </div>
                    <span class="font-bold">UNS Visa System</span>
                </a>
                <span class="text-slate-400">|</span>
                <span class="text-purple-300">åœ¨ç•™è³‡æ ¼èªå®šè¨¼æ˜æ›¸äº¤ä»˜ç”³è«‹æ›¸</span>
            </div>
            <a href="index.html" class="text-sm text-slate-300 hover:text-white">â† ãƒ›ãƒ¼ãƒ ã¸æˆ»ã‚‹</a>
        </div>
    </nav>

    <div class="max-w-5xl mx-auto p-6">
        <!-- Header -->
        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-8 mb-6 border border-white/20">
            <div class="text-center">
                <div class="text-5xl mb-4">ğŸ“„</div>
                <h1 class="text-3xl font-bold text-white mb-2">åœ¨ç•™è³‡æ ¼èªå®šè¨¼æ˜æ›¸äº¤ä»˜ç”³è«‹æ›¸</h1>
                <p class="text-purple-200 text-lg">Certificate of Eligibility Application</p>
                <p class="text-slate-300 text-sm mt-2">æ–°è¦æ¡ç”¨è€…ï¼ˆå›½å¤–ï¼‰å‘ã‘ç”³è«‹æ›¸</p>
            </div>
        </div>

        <!-- Main Form -->
        <form id="coe-form" class="space-y-6">
            <!-- ç”³è«‹è€…æƒ…å ± (Applicant Information) -->
            <div class="bg-white rounded-2xl shadow-xl p-6">
                <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                    <span>ğŸ‘¤</span> ç”³è«‹è€…æƒ…å ± (Applicant Information)
                </h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            æ°åï¼ˆãƒ­ãƒ¼ãƒå­—ï¼‰å§“ <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="family-name" required
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 uppercase focus:ring-2 focus:ring-purple-500"
                               placeholder="NGUYEN">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            æ°åï¼ˆãƒ­ãƒ¼ãƒå­—ï¼‰å <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="given-name" required
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 uppercase focus:ring-2 focus:ring-purple-500"
                               placeholder="VAN MINH">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            æ°åï¼ˆæ¼¢å­—ï¼‰å§“
                        </label>
                        <input type="text" id="family-name-kanji"
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                               placeholder="é˜®">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            æ°åï¼ˆæ¼¢å­—ï¼‰å
                        </label>
                        <input type="text" id="given-name-kanji"
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                               placeholder="æ–‡æ˜">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            ç”Ÿå¹´æœˆæ—¥ <span class="text-red-500">*</span>
                        </label>
                        <input type="date" id="date-of-birth" required
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            æ€§åˆ¥ <span class="text-red-500">*</span>
                        </label>
                        <select id="sex" required class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="male">ç”·æ€§</option>
                            <option value="female">å¥³æ€§</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            å›½ç±ãƒ»åœ°åŸŸ <span class="text-red-500">*</span>
                        </label>
                        <select id="nationality" required class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="ãƒ™ãƒˆãƒŠãƒ ">ãƒ™ãƒˆãƒŠãƒ  (Vietnam)</option>
                            <option value="ä¸­å›½">ä¸­å›½ (China)</option>
                            <option value="ãƒ•ã‚£ãƒªãƒ”ãƒ³">ãƒ•ã‚£ãƒªãƒ”ãƒ³ (Philippines)</option>
                            <option value="ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢">ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢ (Indonesia)</option>
                            <option value="ãƒãƒ‘ãƒ¼ãƒ«">ãƒãƒ‘ãƒ¼ãƒ« (Nepal)</option>
                            <option value="ãƒ–ãƒ©ã‚¸ãƒ«">ãƒ–ãƒ©ã‚¸ãƒ« (Brazil)</option>
                            <option value="éŸ“å›½">éŸ“å›½ (South Korea)</option>
                            <option value="ã‚¤ãƒ³ãƒ‰">ã‚¤ãƒ³ãƒ‰ (India)</option>
                            <option value="ã‚¿ã‚¤">ã‚¿ã‚¤ (Thailand)</option>
                            <option value="ãã®ä»–">ãã®ä»– (Other)</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            å‡ºç”Ÿåœ° <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="birthplace" required
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                               placeholder="Hanoi, Vietnam">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            é…å¶è€…ã®æœ‰ç„¡ <span class="text-red-500">*</span>
                        </label>
                        <select id="marital-status" required class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="æœªå©š">æœªå©š (Single)</option>
                            <option value="æ—¢å©š">æ—¢å©š (Married)</option>
                            <option value="é›¢å©š">é›¢å©š (Divorced)</option>
                            <option value="æ­»åˆ¥">æ­»åˆ¥ (Widowed)</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            è·æ¥­ <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="occupation" required
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                               placeholder="Software Engineer">
                    </div>

                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            æœ¬å›½ã«ãŠã‘ã‚‹å±…æ‰€ <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="home-address" required
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                               placeholder="123 Tran Hung Dao Street, Hoan Kiem District, Hanoi, Vietnam">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            é›»è©±ç•ªå· <span class="text-red-500">*</span>
                        </label>
                        <input type="tel" id="phone" required
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                               placeholder="+84 24 1234 5678">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            Email
                        </label>
                        <input type="email" id="email"
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                               placeholder="example@email.com">
                    </div>
                </div>
            </div>

            <!-- ãƒ‘ã‚¹ãƒãƒ¼ãƒˆæƒ…å ± (Passport Information) -->
            <div class="bg-white rounded-2xl shadow-xl p-6">
                <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                    <span>ğŸ›‚</span> ãƒ‘ã‚¹ãƒãƒ¼ãƒˆæƒ…å ± (Passport Information)
                </h2>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            ãƒ‘ã‚¹ãƒãƒ¼ãƒˆç•ªå· <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="passport-number" required
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 uppercase focus:ring-2 focus:ring-purple-500"
                               placeholder="B12345678">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            ãƒ‘ã‚¹ãƒãƒ¼ãƒˆæœ‰åŠ¹æœŸé™ <span class="text-red-500">*</span>
                        </label>
                        <input type="date" id="passport-expiration" required
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            ç™ºè¡Œå›½
                        </label>
                        <input type="text" id="passport-country"
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                               placeholder="VIETNAM">
                    </div>
                </div>
            </div>

            <!-- å…¥å›½äºˆå®šæƒ…å ± (Entry Plan Information) -->
            <div class="bg-white rounded-2xl shadow-xl p-6">
                <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                    <span>âœˆï¸</span> å…¥å›½äºˆå®šæƒ…å ± (Entry Plan Information)
                </h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            å…¥å›½ç›®çš„ <span class="text-red-500">*</span>
                        </label>
                        <select id="entry-purpose" required class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                            <option value="æŠ€è¡“ãƒ»äººæ–‡çŸ¥è­˜ãƒ»å›½éš›æ¥­å‹™">æŠ€è¡“ãƒ»äººæ–‡çŸ¥è­˜ãƒ»å›½éš›æ¥­å‹™</option>
                            <option value="ç‰¹å®šæŠ€èƒ½1å·">ç‰¹å®šæŠ€èƒ½1å·</option>
                            <option value="æŠ€èƒ½å®Ÿç¿’">æŠ€èƒ½å®Ÿç¿’</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            æ»åœ¨äºˆå®šæœŸé–“ <span class="text-red-500">*</span>
                        </label>
                        <select id="stay-period" required class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="5å¹´">5å¹´</option>
                            <option value="3å¹´">3å¹´</option>
                            <option value="1å¹´">1å¹´</option>
                            <option value="6æœˆ">6æœˆ</option>
                            <option value="3æœˆ">3æœˆ</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            å…¥å›½äºˆå®šæ—¥ <span class="text-red-500">*</span>
                        </label>
                        <input type="date" id="planned-entry-date" required
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            åŒä¼´è€…ã®æœ‰ç„¡ <span class="text-red-500">*</span>
                        </label>
                        <select id="accompanying-family" required class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                            <option value="ç„¡">ç„¡ (None)</option>
                            <option value="æœ‰">æœ‰ (Yes)</option>
                        </select>
                    </div>

                    <div class="md:col-span-2" id="accompanying-details" style="display:none;">
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            åŒä¼´è€…ã®è©³ç´°
                        </label>
                        <textarea id="accompanying-info" rows="2"
                                  class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                                  placeholder="ä¾‹ï¼šé…å¶è€…1åã€å­ä¾›2å"></textarea>
                    </div>
                </div>
            </div>

            <!-- æ‹›ã¸ã„æ©Ÿé–¢æƒ…å ± (Inviting Organization - UNS) -->
            <div class="bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl shadow-xl p-6 border-2 border-purple-200">
                <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                    <span>ğŸ¢</span> æ‹›ã¸ã„æ©Ÿé–¢ (Inviting Organization - UNS)
                </h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">ä¼šç¤¾å</label>
                        <input type="text" id="uns-name" value="UNSæ ªå¼ä¼šç¤¾" readonly
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 bg-white">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">æ³•äººç•ªå·</label>
                        <input type="text" id="uns-corp-number" placeholder="1234567890123"
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                    </div>

                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-slate-700 mb-1">æ‰€åœ¨åœ°</label>
                        <input type="text" id="uns-address" placeholder="æ„›çŸ¥çœŒåå¤å±‹å¸‚..."
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">é›»è©±ç•ªå·</label>
                        <input type="tel" id="uns-phone" placeholder="052-xxx-xxxx"
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">ä»£è¡¨è€…æ°å</label>
                        <input type="text" id="uns-representative" placeholder="å±±ç”° å¤ªéƒ"
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">äº‹æ¥­å†…å®¹</label>
                        <input type="text" id="uns-business" value="åŠ´åƒè€…æ´¾é£æ¥­" readonly
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 bg-white">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">å¾“æ¥­å“¡æ•°</label>
                        <input type="text" id="uns-employees" placeholder="100å"
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                    </div>
                </div>
            </div>

            <!-- æ´¾é£å…ˆæƒ…å ± (Dispatch Destination) -->
            <div class="bg-white rounded-2xl shadow-xl p-6">
                <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                    <span>ğŸ­</span> æ´¾é£å…ˆæƒ…å ± (Dispatch Destination)
                </h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            æ´¾é£å…ˆä¼šç¤¾å <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="haken-name" required
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                               placeholder="æ ªå¼ä¼šç¤¾ã€‡ã€‡">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            æ´¾é£å…ˆé›»è©±ç•ªå·
                        </label>
                        <input type="tel" id="haken-phone"
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                               placeholder="052-xxx-xxxx">
                    </div>

                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            æ´¾é£å…ˆæ‰€åœ¨åœ° <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="haken-address" required
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                               placeholder="æ„›çŸ¥çœŒ...">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            æ‹…å½“è€…å
                        </label>
                        <input type="text" id="haken-contact"
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                               placeholder="ç”°ä¸­ ä¸€éƒ">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            é…å±éƒ¨ç½²
                        </label>
                        <input type="text" id="haken-department"
                               class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                               placeholder="è£½é€ éƒ¨">
                    </div>

                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            æ¥­å‹™å†…å®¹ <span class="text-red-500">*</span>
                        </label>
                        <textarea id="job-description" rows="3" required
                                  class="w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
                                  placeholder="ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºã€ä¿å®ˆã€é‹ç”¨..."></textarea>
                    </div>
                </div>
            </div>

            <!-- å­¦æ­´ãƒ»è·æ­´ (Education & Work History) -->
            <div class="bg-white rounded-2xl shadow-xl p-6">
                <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                    <span>ğŸ“</span> å­¦æ­´ãƒ»è·æ­´ (Education & Work History)
                </h2>

                <div class="space-y-6">
                    <!-- Education -->
                    <div>
                        <h3 class="font-semibold text-slate-700 mb-3">å­¦æ­´ (Education)</h3>
                        <div id="education-list" class="space-y-3">
                            <div class="education-item grid grid-cols-1 md:grid-cols-12 gap-3 p-3 bg-slate-50 rounded-lg">
                                <div class="md:col-span-2">
                                    <input type="text" class="education-from w-full border border-slate-300 rounded px-2 py-1 text-sm"
                                           placeholder="é–‹å§‹å¹´æœˆ" />
                                </div>
                                <div class="md:col-span-2">
                                    <input type="text" class="education-to w-full border border-slate-300 rounded px-2 py-1 text-sm"
                                           placeholder="çµ‚äº†å¹´æœˆ" />
                                </div>
                                <div class="md:col-span-4">
                                    <input type="text" class="education-school w-full border border-slate-300 rounded px-2 py-1 text-sm"
                                           placeholder="å­¦æ ¡å" />
                                </div>
                                <div class="md:col-span-3">
                                    <input type="text" class="education-major w-full border border-slate-300 rounded px-2 py-1 text-sm"
                                           placeholder="å°‚æ”»" />
                                </div>
                                <div class="md:col-span-1 flex justify-center items-center">
                                    <button type="button" onclick="removeEducation(this)" class="text-red-500 hover:text-red-700">âœ•</button>
                                </div>
                            </div>
                        </div>
                        <button type="button" onclick="addEducation()" class="mt-2 text-sm text-purple-600 hover:text-purple-800">
                            + å­¦æ­´ã‚’è¿½åŠ 
                        </button>
                    </div>

                    <!-- Work History -->
                    <div>
                        <h3 class="font-semibold text-slate-700 mb-3">è·æ­´ (Work History)</h3>
                        <div id="work-list" class="space-y-3">
                            <div class="work-item grid grid-cols-1 md:grid-cols-12 gap-3 p-3 bg-slate-50 rounded-lg">
                                <div class="md:col-span-2">
                                    <input type="text" class="work-from w-full border border-slate-300 rounded px-2 py-1 text-sm"
                                           placeholder="é–‹å§‹å¹´æœˆ" />
                                </div>
                                <div class="md:col-span-2">
                                    <input type="text" class="work-to w-full border border-slate-300 rounded px-2 py-1 text-sm"
                                           placeholder="çµ‚äº†å¹´æœˆ" />
                                </div>
                                <div class="md:col-span-4">
                                    <input type="text" class="work-company w-full border border-slate-300 rounded px-2 py-1 text-sm"
                                           placeholder="ä¼šç¤¾å" />
                                </div>
                                <div class="md:col-span-3">
                                    <input type="text" class="work-position w-full border border-slate-300 rounded px-2 py-1 text-sm"
                                           placeholder="è·ä½ãƒ»æ¥­å‹™å†…å®¹" />
                                </div>
                                <div class="md:col-span-1 flex justify-center items-center">
                                    <button type="button" onclick="removeWork(this)" class="text-red-500 hover:text-red-700">âœ•</button>
                                </div>
                            </div>
                        </div>
                        <button type="button" onclick="addWork()" class="mt-2 text-sm text-purple-600 hover:text-purple-800">
                            + è·æ­´ã‚’è¿½åŠ 
                        </button>
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="bg-gradient-to-r from-purple-600 to-blue-600 rounded-2xl shadow-2xl p-8 text-center">
                <button type="submit" class="bg-white text-purple-700 font-bold text-lg px-12 py-4 rounded-xl hover:bg-purple-50 transition-all shadow-lg hover:shadow-xl transform hover:scale-105">
                    <span class="text-2xl mr-2">ğŸ“¥</span>
                    ç”³è«‹æ›¸ã‚’ç”Ÿæˆ (Generate Application)
                </button>
                <p class="text-purple-100 text-sm mt-4">
                    Excelå½¢å¼ã§ç”³è«‹æ›¸ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™
                </p>
            </div>
        </form>
    </div>

    <!-- Footer -->
    <footer class="text-center text-slate-400 text-sm py-8">
        <p>UNS Visa Management System - åœ¨ç•™è³‡æ ¼èªå®šè¨¼æ˜æ›¸äº¤ä»˜ç”³è«‹æ›¸</p>
        <p class="mt-1">Â© 2024 UNSæ ªå¼ä¼šç¤¾</p>
    </footer>

    <script>
        // Show/hide accompanying family details
        document.getElementById('accompanying-family').addEventListener('change', function(e) {
            const details = document.getElementById('accompanying-details');
            details.style.display = e.target.value === 'æœ‰' ? 'block' : 'none';
        });

        // Add education entry
        function addEducation() {
            const list = document.getElementById('education-list');
            const item = document.createElement('div');
            item.className = 'education-item grid grid-cols-1 md:grid-cols-12 gap-3 p-3 bg-slate-50 rounded-lg';
            item.innerHTML = `
                <div class="md:col-span-2">
                    <input type="text" class="education-from w-full border border-slate-300 rounded px-2 py-1 text-sm"
                           placeholder="é–‹å§‹å¹´æœˆ" />
                </div>
                <div class="md:col-span-2">
                    <input type="text" class="education-to w-full border border-slate-300 rounded px-2 py-1 text-sm"
                           placeholder="çµ‚äº†å¹´æœˆ" />
                </div>
                <div class="md:col-span-4">
                    <input type="text" class="education-school w-full border border-slate-300 rounded px-2 py-1 text-sm"
                           placeholder="å­¦æ ¡å" />
                </div>
                <div class="md:col-span-3">
                    <input type="text" class="education-major w-full border border-slate-300 rounded px-2 py-1 text-sm"
                           placeholder="å°‚æ”»" />
                </div>
                <div class="md:col-span-1 flex justify-center items-center">
                    <button type="button" onclick="removeEducation(this)" class="text-red-500 hover:text-red-700">âœ•</button>
                </div>
            `;
            list.appendChild(item);
        }

        function removeEducation(button) {
            const items = document.querySelectorAll('.education-item');
            if (items.length > 1) {
                button.closest('.education-item').remove();
            } else {
                alert('æœ€ä½1ã¤ã®å­¦æ­´é …ç›®ãŒå¿…è¦ã§ã™');
            }
        }

        // Add work history entry
        function addWork() {
            const list = document.getElementById('work-list');
            const item = document.createElement('div');
            item.className = 'work-item grid grid-cols-1 md:grid-cols-12 gap-3 p-3 bg-slate-50 rounded-lg';
            item.innerHTML = `
                <div class="md:col-span-2">
                    <input type="text" class="work-from w-full border border-slate-300 rounded px-2 py-1 text-sm"
                           placeholder="é–‹å§‹å¹´æœˆ" />
                </div>
                <div class="md:col-span-2">
                    <input type="text" class="work-to w-full border border-slate-300 rounded px-2 py-1 text-sm"
                           placeholder="çµ‚äº†å¹´æœˆ" />
                </div>
                <div class="md:col-span-4">
                    <input type="text" class="work-company w-full border border-slate-300 rounded px-2 py-1 text-sm"
                           placeholder="ä¼šç¤¾å" />
                </div>
                <div class="md:col-span-3">
                    <input type="text" class="work-position w-full border border-slate-300 rounded px-2 py-1 text-sm"
                           placeholder="è·ä½ãƒ»æ¥­å‹™å†…å®¹" />
                </div>
                <div class="md:col-span-1 flex justify-center items-center">
                    <button type="button" onclick="removeWork(this)" class="text-red-500 hover:text-red-700">âœ•</button>
                </div>
            `;
            list.appendChild(item);
        }

        function removeWork(button) {
            const items = document.querySelectorAll('.work-item');
            if (items.length > 1) {
                button.closest('.work-item').remove();
            } else {
                alert('æœ€ä½1ã¤ã®è·æ­´é …ç›®ãŒå¿…è¦ã§ã™');
            }
        }

        // Collect education data
        function collectEducation() {
            const items = document.querySelectorAll('.education-item');
            const education = [];
            items.forEach(item => {
                const from = item.querySelector('.education-from').value;
                const to = item.querySelector('.education-to').value;
                const school = item.querySelector('.education-school').value;
                const major = item.querySelector('.education-major').value;
                if (from || to || school || major) {
                    education.push({ from, to, school, major });
                }
            });
            return education;
        }

        // Collect work history data
        function collectWorkHistory() {
            const items = document.querySelectorAll('.work-item');
            const work = [];
            items.forEach(item => {
                const from = item.querySelector('.work-from').value;
                const to = item.querySelector('.work-to').value;
                const company = item.querySelector('.work-company').value;
                const position = item.querySelector('.work-position').value;
                if (from || to || company || position) {
                    work.push({ from, to, company, position });
                }
            });
            return work;
        }

        // Form submission
        document.getElementById('coe-form').addEventListener('submit', async function(e) {
            e.preventDefault();

            // Collect all form data
            const formData = {
                // Applicant info
                family_name: document.getElementById('family-name').value,
                given_name: document.getElementById('given-name').value,
                family_name_kanji: document.getElementById('family-name-kanji').value,
                given_name_kanji: document.getElementById('given-name-kanji').value,
                date_of_birth: document.getElementById('date-of-birth').value,
                sex: document.getElementById('sex').value,
                nationality: document.getElementById('nationality').value,
                birthplace: document.getElementById('birthplace').value,
                marital_status: document.getElementById('marital-status').value,
                occupation: document.getElementById('occupation').value,
                home_address: document.getElementById('home-address').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,

                // Passport info
                passport_number: document.getElementById('passport-number').value,
                passport_expiration: document.getElementById('passport-expiration').value,
                passport_country: document.getElementById('passport-country').value,

                // Entry plan
                entry_purpose: document.getElementById('entry-purpose').value,
                stay_period: document.getElementById('stay-period').value,
                planned_entry_date: document.getElementById('planned-entry-date').value,
                accompanying_family: document.getElementById('accompanying-family').value,
                accompanying_info: document.getElementById('accompanying-info').value,

                // UNS (Inviting organization)
                uns_name: document.getElementById('uns-name').value,
                uns_corp_number: document.getElementById('uns-corp-number').value,
                uns_address: document.getElementById('uns-address').value,
                uns_phone: document.getElementById('uns-phone').value,
                uns_representative: document.getElementById('uns-representative').value,
                uns_business: document.getElementById('uns-business').value,
                uns_employees: document.getElementById('uns-employees').value,

                // Haken-saki (Dispatch destination)
                haken_name: document.getElementById('haken-name').value,
                haken_phone: document.getElementById('haken-phone').value,
                haken_address: document.getElementById('haken-address').value,
                haken_contact: document.getElementById('haken-contact').value,
                haken_department: document.getElementById('haken-department').value,
                job_description: document.getElementById('job-description').value,

                // Education & Work history
                education: collectEducation(),
                work_history: collectWorkHistory()
            };

            console.log('Form data:', formData);

            try {
                // Call API to generate Excel
                const response = await fetch('/api/visa/coe/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    // Download the Excel file
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `COE_${formData.family_name}_${formData.given_name}_${new Date().toISOString().split('T')[0]}.xlsx`;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);

                    alert('ç”³è«‹æ›¸ã‚’ç”Ÿæˆã—ã¾ã—ãŸï¼');
                } else {
                    const error = await response.json();
                    alert('ã‚¨ãƒ©ãƒ¼: ' + (error.detail || 'Failed to generate application'));
                }
            } catch (error) {
                console.error('Error:', error);
                alert('ç”³è«‹æ›¸ã®ç”Ÿæˆä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚\n\nAPI endpoint /api/visa/coe/generate ãŒã¾ã å®Ÿè£…ã•ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚');
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set default entry purpose
            document.getElementById('entry-purpose').value = 'æŠ€è¡“ãƒ»äººæ–‡çŸ¥è­˜ãƒ»å›½éš›æ¥­å‹™';

            // Set minimum date for planned entry (today)
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('planned-entry-date').min = today;

            console.log('COE form initialized');
        });
    </script>
</body>
</html>
